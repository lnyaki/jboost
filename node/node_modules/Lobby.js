//var quizz_module ;
var Player	 = require('Player').Player;

/*var test = new Player("stormwolf");
console.log("My name is "+test.get_name());
console.log(test);*/
module.exports	= (function(){
	var player_list;
	var game_list;
	var lobby_ref;
	var lobby_name;

		
	var Lobby			= function(lobby){
		this.lobby_name 	= lobby;
		this.lobby_ref		= lobby;
		this.player_list 	= new Array();
		this.game_list		= new Array();
	};
	
	Lobby.prototype	= function(){
		var constructor	= Lobby;
		

		
		//set the name of the lobby
		var set_name		= function(name){
			this.lobby_name	= name;
		};
		
		//return the lobby reference
		var get_reference	= function(){
			return this.lobby_ref;
		};
		
		//return the name of the lobby
		var get_name		= function(){
			return this.lobby_name;
		};
		
		//return the list of the players
		var get_players		= function(){
			return this.player_list;
		};
		
		//return a specific user
		var get_player		= function(player_ref){
			return this.player_list[player_ref];
		};
		
		var get_players_data	= function(){
			var players 		= this.player_list;
			var size 			= players.length;
			var players_data 	= {};
			var names = new Array();
			console.log();
			console.log("****************** LOBBY player list ****************** ");
			console.log(this.player_list);
			for(elt in this.player_list){
				names.push(this.player_list[elt].get_name());
			}
			
			players_data.players 	= names;
			players_data.lobby		= this.lobby_name;
			
			return players_data;
		};
		
		//return the list of games in this lobby
		var get_game_list	= function(){
			return this.game_list;
		};
		
		//return a specific game
		var get_game 		= function(game_ref){
			return this.game_list[game_ref];
		};
		
		//add a player to the lobby
		var add_player		= function(param_player){
			console.log("###### AJOUT DE JOUEUR ########");
			var player = new Player(param_player);
			console.log(player);

			//if the user doesn't already exist, we add him to the lobby
			if(this.player_list[player.get_reference()] == undefined){
				this.player_list[player.get_reference()] = player;
				
			}
			else{
				//output or log a warning, because we're trying to add
				//a player that has already been added to this lobby.
			}
			console.log(this.player_list);
		};
		
		//add a game in the game list of this lobby
		var add_game		= function(game){
			//if the game doesn't already exist, we add it to the lobby
			if(this.game_list[game.reference] == undefined){
				this.game_list[game.reference] = game;
			}
			else {
				//output or log a warning, because we're trying to add
				//a game that has already been added to this lobby.
			}
		};
		
		//remove a player from the lobby
		var remove_player	= function(player_ref){
			this.player_list[player_ref] = null;
		};
		
		//remove a game from the game list
		var remove_game		= function(game_ref){
			this.game_list[game_ref] = null;
		};
		
		return{
			get_reference		: get_reference
			,get_name			: get_name
			,get_players		: get_players
			,get_player			: get_player
			,get_players_data	: get_players_data
			,get_game_list		: get_game_list
			,get_game 			: get_game
			,add_player			: add_player
			,add_game			: add_game
			,remove_player		: remove_player
			,remove_game		: remove_game
			,set_name			: set_name
		};
	}();
	
	return {
		Lobby : Lobby
	};
	
})();


